@model IEnumerable<FoodDrive.Models.Review>
@{
    ViewData["Title"] = "Управління відгуками";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-comments me-2"></i>Список відгуків</h2>
        <div>
            <a href="@Url.Action("CreateReview")" class="btn btn-primary">
                <i class="fas fa-plus-circle me-2"></i>Додати відгук
            </a>
            <a href="@Url.Action("Menu")" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>Назад
            </a>
        </div>
    </div>

    <div class="card shadow">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover table-striped">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Користувач</th>
                            <th>Страва</th>
                            <th>Оцінка</th>
                            <th>Текст</th>
                            <th>Дата</th>
                            <th>Дії</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var review in Model)
                        {
                            <tr>
                                <td>#@review.Id</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-sm bg-primary text-white rounded-circle me-2">
                                            @review.User?.Name?[0].ToString().ToUpper()
                                        </div>
                                        @review.User?.Name
                                    </div>
                                </td>
                                <td>@review.Dish?.Name</td>
                                <td>
                                    <div class="rating-stars">
                                        @for (int i = 0; i < 5; i++)
                                        {
                                            <i class="fas fa-star @(i < review.Rating ? "text-warning" : "text-muted")"></i>
                                        }
                                    </div>
                                </td>
                                <td class="text-truncate" style="max-width: 250px;">@review.Text</td>
                                <td>@review.Date.ToString("dd.MM.yyyy HH:mm")</td>
                                <td>
                                    <div class="btn-group">
                                        <a href="@Url.Action("EditReview", new { id = review.Id })"
                                           class="btn btn-sm btn-outline-primary"
                                           data-bs-toggle="tooltip"
                                           title="Редагувати">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <form asp-action="DeleteReview" method="post" class="d-inline">
                                            <input type="hidden" name="id" value="@review.Id" />
                                            <button type="submit"
                                                    class="btn btn-sm btn-outline-danger"
                                                    onclick="return confirm('Ви впевнені, що хочете видалити цей відгук?')"
                                                    data-bs-toggle="tooltip"
                                                    title="Видалити">
                                                <i class="fas fa-trash-alt"></i>
                                            </button>
                                        </form>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<style>
    .avatar-sm {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
    }

    .rating-stars {
        font-size: 1.1rem;
        color: #ffd700;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(0, 0, 0, 0.03);
    }

    .text-truncate {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>

@section Scripts {
    <script>
        // Ініціалізація підказок
        document.addEventListener('DOMContentLoaded', function () {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl)
            })
        })
    </script>
}